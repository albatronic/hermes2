$(function(){$.datepicker.regional.es={closeText:"Cerrar",prevText:"<Ant",nextText:"Sig>",currentText:"Hoy",monthNames:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthNamesShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],dayNames:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],dayNamesShort:["Dom","Lun","Mar","Mié","Juv","Vie","Sáb"],dayNamesMin:["Do","Lu","Ma","Mi","Ju","Vi","Sá"],weekHeader:"Sm",dateFormat:"dd/mm/yy",firstDay:1,isRTL:false,showMonthAfterYear:false,yearSuffix:""};$.datepicker.setDefaults($.datepicker.regional.es);$("#tabs").tabs({active:parseInt($("#solapaActiva").val(),10)});$("#tabs ul li").click(function(){$("#solapaActiva").val($("#tabs").tabs("option","active"))});$("#tabs1").tabs();$("#tabsMostrarEnMenu").tabs();$("#filtroAvanzado").dialog({autoOpen:false,width:340,position:["right","center"],closeOnEscape:true,show:"slide",resizable:false,buttons:{Consultar:function(){$("#div_listado").html("<div class=ListadoAnimation><img src={{app.path}}/images/loadingAnimation.gif /></div>");$("#formFiltroAvanzado").submit()},Cancelar:function(){$(this).dialog("close")}}});$("#filtroAvanzado1").dialog({autoOpen:false,modal:false,width:350,height:540,position:["right","center"],closeOnEscape:true,buttons:{Consultar:function(){var a=$("#filtro");$(formulario).submit(function(c){var b=a.serialize();alert(b);var d=$.ajax({url:appPath+"/GconContenidos/list",data:b,type:"POST"});d.done(function(){$(this).dialog("close")})})},Cancelar:function(){$(this).dialog("close")}}});$("#accordion").accordion({autoHeight:false,navigation:true,collapsible:true});$("#dialogoVarEnv").dialog({autoOpen:false,modal:false,width:400,height:350,position:["right","center"],closeOnEscape:true});$("#dialogOrdenar").dialog({autoOpen:false,width:500,height:500,closeOnEscape:true});$("#notificacion").dialog({resizable:true,modal:true,buttons:{Aceptar:function(){$(this).dialog("close")}},autoOpen:false,dialogClass:"alert",width:400,height:200,position:["center","center"],closeOnEscape:true});$("#acordeonColumnas").accordion({autoHeight:false,navigation:true,collapsible:true,active:false,heightStyle:"content"});$("#acordeonVW").accordion({autoHeight:false,navigation:true,collapsible:true,active:false,heightStyle:"content"});$("#acordeonOrdenesWeb").accordion({autoHeight:false,navigation:true,collapsible:true,active:false,heightStyle:"content"});$("#usersSelector").change(function(){submitForm("layoutForm")});$("#projectsSelector").change(function(){submitForm("layoutForm")})});function pintaTotales(c,b){var a=appPath+"/lib/getObjeto.php?formato=JSON&entidad="+c+"&idEntidad="+b;$.getJSON(a,function(d){parent.document.getElementById(c+"_LiteralTotal").innerHTML="TOTAL "+d.Total;parent.document.getElementById(c+"_Importe").value=d.Importe;parent.document.getElementById(c+"_Descuento").value=d.Descuento;parent.document.getElementById(c+"_BaseImponible1").value=d.BaseImponible1;parent.document.getElementById(c+"_BaseImponible2").value=d.BaseImponible2;parent.document.getElementById(c+"_BaseImponible3").value=d.BaseImponible3;parent.document.getElementById(c+"_Iva1").value=d.Iva1;parent.document.getElementById(c+"_Iva2").value=d.Iva2;parent.document.getElementById(c+"_Iva3").value=d.Iva3;parent.document.getElementById(c+"_CuotaIva1").value=d.CuotaIva1;parent.document.getElementById(c+"_CuotaIva2").value=d.CuotaIva2;parent.document.getElementById(c+"_CuotaIva3").value=d.CuotaIva3;parent.document.getElementById(c+"_Recargo1").value=d.Recargo1;parent.document.getElementById(c+"_Recargo2").value=d.Recargo2;parent.document.getElementById(c+"_Recargo3").value=d.Recargo3;parent.document.getElementById(c+"_CuotaRecargo1").value=d.CuotaRecargo1;parent.document.getElementById(c+"_CuotaRecargo2").value=d.CuotaRecargo2;parent.document.getElementById(c+"_CuotaRecargo3").value=d.CuotaRecargo3;parent.document.getElementById(c+"_TotalBases").value=d.TotalBases;parent.document.getElementById(c+"_TotalIva").value=d.TotalIva;parent.document.getElementById(c+"_TotalRecargo").value=d.TotalRecargo})}function solapaActiva(a){alert(a)}function AcordeonActivo(a){$("#acordeonActivo").val(a)}function ocultarElemento(a){if($("#"+a).length){$("#"+a).css("display","none")}}function mostrarElemento(a){if($("#"+a).length){$("#"+a).css("display","block")}}function switchDisplay(a){if($("#"+a).css("display")=="block"){$("#"+a).css("display","none")}else{$("#"+a).css("display","block")}}function popUpVariablesEnv(c,f,g){var e=g.split("_");var d=e[0];var a=e[1];var b='<iframe src="'+appPath+"/CpanVariables/EditNode/"+f+"/"+c+"/"+d+"/"+a+'" width="100%" height="98%"></iframe>';$("#dialogoVarEnv").html(b);$("#dialogoVarEnv").dialog("open")}function popUpOrdenar(c,a,e,b){var d='<iframe src="'+appPath+"/Ordenar/Index/"+c+"/"+a+"/"+e+"/"+b+'" width="100%" height="98%"></iframe>';$("#dialogOrdenar").html(d);$("#dialogOrdenar").dialog("open")}function cargaEtiquetasRelacionadas(d,c,a){var b='<iframe src="'+appPath+"/EtiqRelaciones/list/"+c+"/"+a+'" width="100%" height="520"><p>Tu navegador no soporta iframes</p></iframe>';$("#"+d).html(b)}function Confirma(a){var b=$('<div title="Confirmación"><p>'+a+"</p></div>");$("#dialog:ui-dialog").dialog("destroy");b.dialog({autoOpen:true,dialogClass:"alert",resizable:false,height:150,modal:true,show:"fold",hide:"scale",buttons:{Aceptar:function(){$(this).dialog("close");return true},Cancelar:function(){$(this).dialog("close");return false}}})}function submitForm(a){$("#"+a).submit()}function Confirma1(a){if(confirm(a)){return true}else{return false}}function CerrarVentana(){window.close()}function Redondear(c,a){var b=parseFloat(c);var d=parseFloat(a);d=(!d?2:d);return Math.round(b*Math.pow(10,d))/Math.pow(10,d)}function borraMetadato(e,a){var c=appPath+"/lib/metaDatos.php";var b="entidad="+e+"&metadato="+a+"&accion=B";var d;d=$("#div_metaDato_"+a).html();$("#div_metaDato_"+a).html("<img src='"+appPath+"/images/loading.gif'>");$("#resultadoMetaDatos").load(c,b,function(){if($("#resultadoMetaDatos").html()==="1"){$("#div_metaDato_"+a).html("")}else{$("#div_metaDato_"+a).html(d)}})}function creaMetadato(g,a,f){a=a.replace(/ /g,"_");var d=appPath+"/lib/metaDatos.php";var c="entidad="+g+"&metadato="+a+"&idEntidad="+f+"&accion=C";var e,b;if(a!==""){$("#resultadoMetaDatos").load(d,c,function(){if($("#resultadoMetaDatos").html()==="1"){$("#metaDato_nuevo").val("");e=$("#div_metaDatos").html();b="<div id='div_metaDato_"+a+"' class='Item'><span class='Etiqueta'><span>"+a+"</span></span><textarea name='metaDato["+a+"]' id='metaDato_"+a+"' class='TextAreaMeta' rows='2' columns='75'></textarea></div></div>";e=e+b;$("#div_metaDatos").html(e)}if($("#resultadoMetaDatos").html()==="2"){alert("Ese campo ya existe")}})}else{alert("Debe indicar un nombre")}}function ValidaNif(a){cadena="TRWAGMYFPDXBNJZSQVHLCKET";mensaje="";caracteres=$("#"+a).val().length;if((caracteres<7)||(caracteres>9)){mensaje="Faltan caracteres"}else{nif=$("#"+a).val();primero=nif.substring(0,1);if(!isNaN(primero)){numeros=nif.substring(0,8);letra=nif.substring(8,1);posicion=numeros%23;letraok=cadena.substring(posicion,posicion+1);$("#"+a).val(numeros+letraok)}}if(mensaje!==""){$("#notificacion").html(mensaje);$("#notificacion").dialog("open")}}function esNumero(a){return(/^([0-9])*.([0-9])*$/.test(a))}function IsNumeric(a){return !isNaN(a)}var primerslap=false;var segundoslap=false;function formateafecha(a){var d=a.length;var e;var b;var c;if((d>=2)&&(primerslap==false)){e=a.substr(0,2);if((IsNumeric(e)==true)&&(e<=31)&&(e!="00")){a=a.substr(0,2)+"/"+a.substr(3,7);primerslap=true}else{a="";primerslap=false}}else{e=a.substr(0,1);if(IsNumeric(e)==false){a=""}if((d<=2)&&(primerslap=true)){a=a.substr(0,1);primerslap=false}}if((d>=5)&&(segundoslap==false)){b=a.substr(3,2);if((IsNumeric(b)===true)&&(b<=12)&&(b!=="00")){a=a.substr(0,5)+"/"+a.substr(6,4);segundoslap=true}else{a=a.substr(0,3);segundoslap=false}}else{if((d<=5)&&(segundoslap==true)){a=a.substr(0,4);segundoslap=false}}if(d>=7){c=a.substr(6,4);if(IsNumeric(c)==false){a=a.substr(0,6)}else{if(d===10){if((c===0)||(c<1900)||(c>2100)){a=a.substr(0,6)}}}}if(d>=10){a=a.substr(0,10);e=a.substr(0,2);b=a.substr(3,2);c=a.substr(6,4);if((c%4!==0)&&(b===2)&&(e>28)){a=a.substr(0,2)+"/"}}return(a)}function loading(b){var a="<img src='"+appPath+"/images/loadingAnimation.gif'/>";$("#"+b).html(a)}function DesplegableAjax(g,b,f,e,a){var d=appPath+"/lib/desplegableAjax.php";var c="t="+e+"&filtro="+a+"&idselect="+b+"&nameselect="+f;$("#"+g).html("<img src='"+appPath+"/images/loading.gif'>");jQuery("#"+g).load(d,c)}function autoCompletar(c,b,a,f,e,d){$("#"+c).autocomplete({source:appPath+"/lib/autoCompletar.php?idSucursal="+e+"&entidad="+f,minLength:2,select:function(g,h){devuelve(b,h.item.id,a,h.item.value,d)}})}function autoComplete(e,d,b,h,a,g,f){var c=appPath+"/lib/autoCompletar.php?entidad="+h+"&columna="+a+"&filtroAdicional="+g;$("#"+e).autocomplete({source:c,minLength:2,select:function(i,j){devuelve(d,j.item.id,b,j.item.value,f)}})}function devuelve(b,f,a,d,c){$("#"+b).val(f);$("#"+a).val(d);if(c.length>0){var e=c;DesplegableAjax(e[0],e[1],e[2],e[3],f)}$("#"+a).focus()}function actualizaColumna(e,d,a,c){var b="entidad="+e+"&idEntidad="+d+"&columna="+a+"&valor="+c;$.ajax({url:appPath+"/lib/actualizaColumna.php",type:"GET",async:true,data:b})}function actualizaVarEntorno(a,c){var b="entidadColumnaPropiedad="+a+"&valor="+c;$.ajax({url:appPath+"/lib/actualizaVarEntorno.php",type:"GET",async:true,data:b})}function actualizaPermiso(a,b,e,d){var c="idPerfil="+a+"&nombreModulo="+b+"&permiso="+e+"&valor="+d;$.ajax({url:appPath+"/lib/actualizaPermiso.php",type:"GET",async:true,data:c})}function actualizaRelacion(f,e,d,c,a){var b="entidadOrigen="+f+"&idOrigen="+e+"&entidadDestino="+d+"&idDestino="+c+"&onOff="+a;$.ajax({url:appPath+"/lib/actualizaRelacion.php",type:"GET",async:true,data:b})}function actualizaEtiquetasRelacionadas(c,d,e,a){var b="idModulo="+c+"&idEntidad="+d+"&idEtiqueta="+e+"&onOff="+a;$.ajax({url:appPath+"/lib/etiquetasRelacionadas.php",type:"GET",async:true,data:b})}function actualizaArticuloPropiedad(c,d,e){var b=appPath+"/lib/actualizaArticuloPropiedad.php";var a="idArticulo="+c+"&idPropiedad="+d+"&idValor="+e;$("#resultado").load(b,a)}function actualizaTablaPortes(f,e,a,d){var c=appPath+"/lib/actualizaTablaPortes.php";var b="idAgencia="+f+"&idZona="+e+"&kilos="+a+"&importe="+d;$("#resultado").load(c,b)}function actualizaFamiliaPropiedad(a,e,d){var c=appPath+"/lib/actualizaFamiliaPropiedad.php";var b="idFamilia="+a+"&idPropiedad="+e+"&valor="+d;$("#resultado").load(c,b)}function actualizaFamiliaPropiedadFiltrable(a,e,d){var c=appPath+"/lib/actualizaFamiliaPropiedadFiltrable.php";var b="idFamilia="+a+"&idPropiedad="+e+"&valor="+d;$("#resultado").load(c,b)}function notificacion(e,d){var b=0;var a="";for(var c=0;c<=e.length;c++){if(e[c]==="#"){a+="<p>"+e.substring(c,b)+"</p>";b=c+1}}$("#notificacion").html(a);$("#notificacion").dialog("open")}function CrearLote(d,k,h,i,e,f,g,c,b){var a=appPath+"/lib/crearlote.php";var j="puntero="+d+"&idArticulo="+e+"&lote="+f+"&fFabricacion="+g+"&fCaducidad="+c+"&idSelect="+h+"&nameSelect="+i+"&width="+b;$("#"+k).html("<img src='"+appPath+"/images/loading.gif' />");jQuery("#"+k).load(a,j)}function lookup(b,e,f,c,g,a,d){if(a.length<3){$("#suggestions"+b).hide()}else{$.post(appPath+"/lib/autoCompletar.php",{key:""+b+"",idSucursal:""+e+"",idInput:""+f+"",idTexto:""+c+"",entidad:""+g+"",valor:""+a+"",desplegableAjax:""+d+""},function(h){if(h.length>0){$("#suggestions"+b).show();$("#autoSuggestionsList"+b).html(h)}})}}function fill(b,f,e,c,a,d){$("#"+f).val(e);$("#"+c).val(a);setTimeout("$('#suggestions"+b+"').hide();",200);if(d.length>0){var g=d.split(",");DesplegableAjax(g[0],g[1],g[2],g[3],e)}}function hideSuggestions(a){setTimeout("$('#suggestions"+a+"').hide();",200)}function documentos(e,d,c){var b=appPath+"/lib/documentos.php";var a="id="+d+"&entidad="+e;$("#"+c).html("<img src='"+appPath+"/images/loading.gif'>");jQuery("#"+c).load(b,a)}function isEmail(b){var c=b.indexOf("@",0);if(c<=0){return false}var a=b.indexOf(".",c);if(a==-1){return false}if(a+1==b.length){return false}if(!contieneCaracteresPermitidos(b.substr(a+1),"._-")){return false}return true}function isAlfanumerico(b){var d=b.length;var e;b=b.toLowerCase();if(d>0){e=b.charAt(0);if(!(e>="a"&&e<="z")){return false}}for(var a=1;a<d;a++){e=b.charAt(a);if((e>="0"&&e<="9")||(e>="a"&&e<="z")||e=="_"||e=="."){continue}else{return false}}return true}function contieneCaracteresPermitidos(d,f){var e=d.length;var g;d=d.toLowerCase();for(var b=0;b<e;b++){g=d.charAt(b);if((g>="0"&&g<="9")||(g>="a"&&g<="z")){continue}else{for(var a=0;a<f.length;a++){if(f.indexOf(g)==-1){return false}}}}return true};